c ************************************************************************
c EOF 'integ.f'
c ************************************************************************
c ************************************************************************
c EOF 'integ.f'
c ************************************************************************
c ************************************************************************
c EOF 'integ.f'
c ************************************************************************
c ************************************************************************
c EOF 'integ.f'
c ************************************************************************
c ************************************************************************
c EOF 'integ.f'
c ************************************************************************
c ************************************************************************
      subroutine interp(a,b,f,f0,x,cc)
      implicit none
c ************************************************************************
      double precision a,b,f,f0,x,cc
      
      double precision  aa,bb,c,d,ff,sig,xa,xe,fa,fb
      intrinsic dsign
      
c ------------------------------------------------------------------------
      if (f0.gt.f) stop 'interp 1'

      sig=dsign(1.0d0,2*f-a-b)

c      write(6,*) 'sig :',sig
c      write(6,*) dx(a,b,f,0.0d0)
c      write(6,*) dx(a,b,f,1.0d0)

      xa=0.0d0
      xe=1.0d0
      do 10 while (xe-xa.gt.1.0d-8)
        x=(xa+xe)/2.0d0
        c = 2.0d0*f - (a-b)*x - b
        d = (c-a)*(2.0d0*x-1.d0) + x*(a-b)
c        write(6,*) 'xa,xe,x,d :',xa,xe,x,d
        xa = x
        if (sig*d.gt.0.0d0) xe = x
 10   end do

      c= 2.0d0*f - (a-b)*x - b
      fa = (a+c)*x/2.0d0
      fb = (b+c)*(1.d0-x)/2.0d0

      write(6,FMT='(''a,b,f,f0  :'',6f12.6)') a,b,f,f0

      write(6,FMT='(''c,x,fa,fb :'',6f12.6)') c,x,fa,fb

      if (f0.le.fa) then
        aa = x/(c-a)
        bb = a
        ff = f0
      else
        aa = (1.d0-x)/(c-b)
        bb = b
        ff = f-f0
      end if
      x = -aa*bb + dsign(dsqrt(aa*aa*bb*bb+2.0d0*aa*ff),aa*bb)
      cc = bb + x/aa
      if (f0.gt.fa) x = 1.0d0 - x
      return 
      end
